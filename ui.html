<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>A11y Annotator</title>
    <style>
      body { font: 12px -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif; margin: 12px; }
      .row { margin-bottom: 8px; }
      button { padding: 6px 10px; }
      pre { background: #f6f6f6; padding: 8px; border-radius: 4px; white-space: pre-wrap; word-break: break-word; }
    </style>
  </head>
  <body>
    <div class="row">
      <label><input type="radio" name="platform" value="rn" checked /> React Native</label>
      <label style="margin-left:12px;"><input type="radio" name="platform" value="web" /> Web (ARIA)</label>
    </div>
    <div class="row">
      <div id="status" style="font: 12px/1.4 ui-sans-serif, system-ui; margin-bottom: 8px;"></div>
      <button id="proposeBtn">Propose Focus Order</button>
    </div>
    <div class="row"><textarea id="textPrompt" placeholder="ARIA prompt for web platform..." style="width:100%; height:60px;"></textarea></div>
    <div class="row"><pre id="output"></pre></div>

    <script>
      function setStatus(s, isError) {
        var el = document.getElementById('status');
        if (!el) return;
        el.textContent = s;
        el.style.color = isError ? '#b00020' : '#222';
      }

      function getSelectedPlatform() {
        var r = document.querySelector('input[name="platform"]:checked');
        return (r && r.value) || 'web';
      }
      function getTextPrompt() {
        var t = document.getElementById('textPrompt');
        return (t && t.value) || '';
      }

      document.getElementById('proposeBtn').onclick = function () {
        setStatus('Sendingâ€¦');
        var platform = getSelectedPlatform();
        var textPrompt = getTextPrompt();
        parent.postMessage({ pluginMessage: { type: 'PROPOSE', platform: platform, textPrompt: textPrompt } }, '*');
      };

      window.onmessage = function (e) {
        var msg = e.data && e.data.pluginMessage;
        if (!msg) return;
        if (msg.type === 'RESULT') {
          try { console.log('[UI] RESULT', msg.payload); } catch (e) {}
          if (!msg.payload || msg.payload.ok === false) {
            setStatus('Error: ' + JSON.stringify(msg.payload), true);
          } else {
            setStatus('Done: ' + JSON.stringify(msg.payload));
          }
        }
      };
    </script>
  </body>
</html>